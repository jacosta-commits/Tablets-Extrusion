;<!DOCTYPE html>
<html lang="es">
<head>
  <script>
    (function () {
      var hasPrefix = location.pathname.startsWith('/apps/extrusion');
      var base = hasPrefix ? '/apps/extrusion/' : '/';
      // inyecta <base> ANTES de cargar CSS/JS
      document.write('<base href="' + base + '">');

      // para preload.js
      window.__APP_BASE__ = base.replace(/\/$/, ''); // '/' → '', '/apps/extrusion/' → '/apps/extrusion'
      window.__SOCKET_PATH__ =
        window.__APP_BASE__ && window.__APP_BASE__ !== '/'
          ? window.__APP_BASE__ + '/socket.io'
          : '/socket.io';
    })();
  </script>
  <meta charset="utf-8" />
  <title>Pantallas – Extrusión</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="preload" href="./assets/fonts/SegoeUI-Light.woff" as="font" type="font/woff" crossorigin>
  <link rel="stylesheet" href="./index.css">
  <style>
    /* Aseguramos que el modal y su contenido estén arriba de todo */
    .modal { z-index: 2000; }
    .modal-content { z-index: 2001; }
    .close-btn { z-index: 2002; }
    /* Ocultamos el botón “Historial” mientras el modal está abierto */
    .modal:not(.hidden) ~ #history-btn { display: none; }
  </style>
</head>
<body>

  <!-- Botón Historial fijo -->
  <div class="head-tools">
    <button id="history-btn" class="btn">Historial</button>
  </div>

  <!-- Modal de Historial -->
  <div id="history-modal" class="modal hidden">
    <div class="modal-content">
      <header>
        <h1>Historial de Alarmas</h1>
        <button id="close-history" class="close-btn">✕</button>
      </header>
      <section class="filters">
        <label>Desde: <input type="date" id="history-from"></label>
        <label>Hasta: <input type="date" id="history-to"></label>
        <button id="load-history" class="btn">Cargar</button>
      </section>
      <div id="history-tables"><!-- Aquí se inyectarán las tablas de TK1, TK2 y SIMA --></div>
    </div>
  </div>

    <div id="wrap"><!-- contenedor flex de las tres máquinas -->


    <!-- ════════════════════════  TK-1  ════════════════════════ -->
    <article class="machine" id="tk1-card">
      <h1 class="mach-title">TK1</h1>
      <header class="box">
        <div class="prod na" id="tk1-prod">Sin Datos</div>
        <div class="ot   na" id="tk1-ot">Sin Datos</div>
      </header>

      <section class="box dosificacion">
        <h3>DOSIFICACIÓN</h3>
        <div class="two-col">
          <span><span id="tk1-hdpe"  class="na">Sin Datos</span></span>
          <span><span id="tk1-vista" class="na">Sin Datos</span></span>
          <span><span id="tk1-uv"    class="na">Sin Datos</span></span>
          <span><span id="tk1-color" class="na">Sin Datos</span></span>
        </div>
      </section>

      <section class="box">
        <h3>VELOCIDAD</h3>
        <table class="tbl">
          <thead>
            <tr><th></th><th>Actual</th><th class="sep">|</th><th>Límites de Proceso</th></tr>
          </thead>
          <tbody>
            <tr>
              <td>LÍNEA (%):</td>
              <td id="tk1-line_speed"   class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="tk1-line-set"     class="na">Sin Datos</td>
            </tr>
            <tr>
              <td>ESTIRAJE:</td>
              <td id="tk1-est"          class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="tk1-est-set"      class="na">Sin Datos</td>
            </tr>
          </tbody>
        </table>
      </section>

      <section class="box">
        <h3>PRESIÓN</h3>
        <table class="tbl">
          <thead>
            <tr><th></th><th>Actual</th><th class="sep">|</th><th>Límites de Proceso</th></tr>
          </thead>
          <tbody>
            <tr>
              <td>SEGURIDAD (bar):</td>
              <td id="tk1-before_filter_pv" class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="tk1-seg-set"         class="na">Sin Datos</td>
            </tr>
            <tr>
              <td>TRABAJO (bar):</td>
              <td id="tk1-after_filter_pv" class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="tk1-trab-set"        class="na">Sin Datos</td>
            </tr>
            <tr>
              <td>CABEZA (bar):</td>
              <td id="tk1-pump_press_pv"   class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="tk1-cab-set"         class="na">Sin Datos</td>
            </tr>
          </tbody>
        </table>
      </section>

      <section class="box">
        <h3>TEMPERATURA</h3>
        <table class="tbl">
          <thead>
            <tr><th></th><th>Actual</th><th class="sep">|</th><th>Límites de Proceso</th></tr>
          </thead>
          <tbody>
            <tr>
              <td>T. AGUA (°C):</td>
              <td id="tk1-tina_agua_pv"   class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="tk1-tagua-set"      class="na">Sin Datos</td>
            </tr>
            <tr>
              <td>H. ESTIRO 1 (°C):</td>
              <td id="tk1-horno_estiro_h1_pv" class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="tk1-hestiro1-set"   class="na">Sin Datos</td>
            </tr>
            <tr>
              <td>H. ESTIRO 2 (°C):</td>
              <td id="tk1-horno_estiro_h2_pv" class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="tk1-hestiro2-set"   class="na">Sin Datos</td>
            </tr>
            <tr>
              <td>H. ESTAB H1 (°C):</td>
              <td id="tk1-horno_estab_h1_pv" class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="tk1-hestab1-set"    class="na">Sin Datos</td>
            </tr>
            <tr>
              <td>H. ESTAB H2 (°C):</td>
              <td id="tk1-horno_estab_h2_pv" class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="tk1-hestab2-set"    class="na">Sin Datos</td>
            </tr>
            <tr>
              <td>T. PRE-CALENTAMIENTO (°C):</td>
              <td id="tk1-tanque_enfri_pv"   class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="tk1-tenfriamiento-set" class="na">Sin Datos</td>
            </tr>
            <tr>
              <td>CHILLER (°C):</td>
              <td id="tk1-chiller_pv"     class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="tk1-chiller-set"    class="na">Sin Datos</td>
            </tr>
          </tbody>
        </table>
      </section>

      <section class="box">
        <h3>ALARMAS</h3>
        <ul class="alarms-list" id="tk1-alarms"></ul>
      </section>
    </article>

    <!-- ════════════════════════  TK-2  ════════════════════════ -->
    <article class="machine" id="tk2-card">
      <h1 class="mach-title">TK2</h1>
      <header class="box">
        <div class="prod na" id="tk2-prod">Sin Datos</div>
        <div class="ot   na" id="tk2-ot">Sin Datos</div>
      </header>

      <section class="box dosificacion">
        <h3>DOSIFICACIÓN</h3>
        <div class="two-col">
          <span><span id="tk2-hdpe"  class="na">Sin Datos</span></span>
          <span><span id="tk2-vista" class="na">Sin Datos</span></span>
          <span><span id="tk2-uv"    class="na">Sin Datos</span></span>
          <span><span id="tk2-color" class="na">Sin Datos</span></span>
        </div>
      </section>

      <section class="box">
        <h3>VELOCIDAD</h3>
        <table class="tbl">
          <thead>
            <tr><th></th><th>Actual</th><th class="sep">|</th><th>Límites de Proceso</th></tr>
          </thead>
          <tbody>
            <tr>
              <td>LÍNEA (%):</td>
              <td id="tk2-line_speed"    class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="tk2-line-set"      class="na">Sin Datos</td>
            </tr>
            <tr>
              <td>ESTIRAJE:</td>
              <td id="tk2-est"           class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="tk2-est-set"       class="na">Sin Datos</td>
            </tr>
          </tbody>
        </table>
      </section>

      <section class="box">
        <h3>PRESIÓN</h3>
        <table class="tbl">
          <thead>
            <tr><th></th><th>Actual</th><th class="sep">|</th><th>Límites de Proceso</th></tr>
          </thead>
          <tbody>
            <tr>
              <td>SEGURIDAD (bar):</td>
              <td id="tk2-before_filter_pv" class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="tk2-seg-set"          class="na">Sin Datos</td>
            </tr>
            <tr>
              <td>TRABAJO (bar):</td>
              <td id="tk2-after_filter_pv"  class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="tk2-trab-set"         class="na">Sin Datos</td>
            </tr>
            <tr>
              <td>CABEZA (bar):</td>
              <td id="tk2-pump_press_pv"    class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="tk2-cab-set"          class="na">Sin Datos</td>
            </tr>
          </tbody>
        </table>
      </section>

      <section class="box">
        <h3>TEMPERATURA</h3>
        <table class="tbl">
          <thead>
            <tr><th></th><th>Actual</th><th class="sep">|</th><th>Límites de Proceso</th></tr>
          </thead>
          <tbody>
            <tr>
              <td>T. AGUA (°C):</td>
              <td id="tk2-tina_agua_pv"    class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="tk2-tagua-set"       class="na">Sin Datos</td>
            </tr>
            <tr>
              <td>H. ESTIRO 1 (°C):</td>
              <td id="tk2-horno_estiro_h1_pv" class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="tk2-hestiro1-set"    class="na">Sin Datos</td>
            </tr>
            <tr>
              <td>H. ESTIRO 2 (°C):</td>
              <td id="tk2-horno_estiro_h2_pv" class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="tk2-hestiro2-set"    class="na">Sin Datos</td>
            </tr>
            <tr>
              <td>H. ESTAB H1 (°C):</td>
              <td id="tk2-horno_estab_h1_pv" class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="tk2-hestab1-set"    class="na">Sin Datos</td>
            </tr>
            <tr>
              <td>H. ESTAB H2 (°C):</td>
              <td id="tk2-horno_estab_h2_pv" class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="tk2-hestab2-set"    class="na">Sin Datos</td>
            </tr>
            <tr>
              <td>T. PRE-CALENTAMIENTO (°C):</td>
              <td id="tk2-tanque_enfri_pv"   class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="tk2-tenfriamiento-set" class="na">Sin Datos</td>
            </tr>
            <tr>
              <td>CHILLER (°C):</td>
              <td id="tk2-chiller_pv"      class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="tk2-chiller-set"     class="na">Sin Datos</td>
            </tr>
          </tbody>
        </table>
      </section>

      <section class="box">
        <h3>ALARMAS</h3>
        <ul class="alarms-list" id="tk2-alarms"></ul>
      </section>
    </article>

    <!-- ════════════════════════  SIMA  ════════════════════════ -->
    <article class="machine" id="sima-card">
      <h1 class="mach-title">SIMA</h1>
      <header class="box">
        <div class="prod na" id="sima-prod">Sin Datos</div>
        <div class="ot   na" id="sima-ot">Sin Datos</div>
      </header>

      <section class="box dosificacion">
        <h3>DOSIFICACIÓN</h3>
        <div class="two-col">
          <span><span id="sima-hdpe"  class="na">Sin Datos</span></span>
          <span><span id="sima-vista" class="na">Sin Datos</span></span>
          <span><span id="sima-uv"    class="na">Sin Datos</span></span>
          <span><span id="sima-color" class="na">Sin Datos</span></span>
        </div>
      </section>

      <section class="box">
        <h3>VELOCIDAD</h3>
        <table class="tbl">
          <thead>
            <tr><th></th><th>Actual</th><th class="sep">|</th><th>Límites de Proceso</th></tr>
          </thead>
          <tbody>
            <tr>
              <td>LÍNEA (%):</td>
              <td id="sima-line_speed"      class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="sima-line-set"        class="na">Sin Datos</td>
            </tr>
            <tr>
              <td>ESTIRAJE:</td>
              <td id="sima-est"             class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="sima-est-set"         class="na">Sin Datos</td>
            </tr>
          </tbody>
        </table>
      </section>

      <section class="box">
        <h3>PRESIÓN</h3>
        <table class="tbl">
          <thead>
            <tr><th></th><th>Actual</th><th class="sep">|</th><th>Límites de Proceso</th></tr>
          </thead>
          <tbody>
            <tr>
              <td>SEGURIDAD (bar):</td>
              <td id="sima-before_filter_pv" class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="sima-seg-set"           class="na">Sin Datos</td>
            </tr>
            <tr>
              <td>TRABAJO (bar):</td>
              <td id="sima-after_filter_pv"   class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="sima-trab-set"          class="na">Sin Datos</td>
            </tr>
            <tr>
              <td>CABEZA (bar):</td>
              <td id="sima-pump_press_pv"     class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="sima-cab-set"           class="na">Sin Datos</td>
            </tr>
          </tbody>
        </table>
      </section>

      <section class="box">
        <h3>TEMPERATURA</h3>
        <table class="tbl">
          <thead>
            <tr><th></th><th>Actual</th><th class="sep">|</th><th>Límites de Proceso</th></tr>
          </thead>
          <tbody>
            <tr>
              <td>T. AGUA (°C):</td>
              <td id="sima-tina_agua_pv"    class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="sima-tagua-set"       class="na">Sin Datos</td>
            </tr>
            <tr>
              <td>H. ESTIRO H1:</td>
              <td id="sima-horno_estiro_h1_pv" class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="sima-hestiro1-set"   class="na">Sin Datos</td>
            </tr>
            <tr>
              <td>H. ESTIRO H2:</td>
              <td id="sima-horno_estiro_h2_pv" class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="sima-hestiro2-set"   class="na">Sin Datos</td>
            </tr>
            <tr>
              <td>H. ESTAB H1 (°C):</td>
              <td id="sima-horno_estab_h1_pv" class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="sima-hestab1-set"    class="na">Sin Datos</td>
            </tr>
            <tr>
              <td>H. ESTAB H2 (°C):</td>
              <td id="sima-horno_estab_h2_pv" class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="sima-hestab2-set"    class="na">Sin Datos</td>
            </tr>
            <tr>
              <td>CHILLER (°C):</td>
              <td id="sima-chiller_pv"      class="na">Sin Datos</td>
              <td class="sep">|</td>
              <td id="sima-chiller-set"     class="na">Sin Datos</td>
            </tr>
          </tbody>
        </table>
      </section>

      <section class="box">
        <h3>ALARMAS</h3>
        <ul class="alarms-list" id="sima-alarms"></ul>
      </section>
    </article>

    </div><!-- /wrap -->


  <!-- Cliente Socket.IO + shim (preload) + tu lógica -->
  <script src="https://cdn.socket.io/4.7.5/socket.io.min.js" crossorigin="anonymous"></script>
  <script src="./preload.js"></script>
  <script src="./renderer.js"></script>

</body>
</html>
